add_library(core STATIC)
set_target_properties(core PROPERTIES POSITION_INDEPENDENT_CODE ON)

target_compile_features(core PUBLIC cxx_std_20)

target_include_directories(core PUBLIC include)

target_include_directories(core SYSTEM PUBLIC "${CMAKE_SOURCE_DIR}/3dparty")
target_include_directories(core SYSTEM PUBLIC
    "${CMAKE_SOURCE_DIR}/3dparty/lib3mf/Autogenerated/Bindings/Cpp")
set(_opencv_root "${OpenCV_SOURCE_DIR}")
if(NOT _opencv_root)
    set(_opencv_root "${CMAKE_SOURCE_DIR}/3dparty/opencv")
endif()
set(_opencv_build "${OpenCV_BINARY_DIR}")
if(NOT _opencv_build)
    set(_opencv_build "${CMAKE_BINARY_DIR}/3dparty/opencv")
endif()
set(_opencv_cfg_inc "${OPENCV_CONFIG_FILE_INCLUDE_DIR}")
if(NOT _opencv_cfg_inc)
    set(_opencv_cfg_inc "${CMAKE_BINARY_DIR}")
endif()
target_include_directories(core SYSTEM PUBLIC
    "${_opencv_root}/include"
    "${_opencv_root}/modules/core/include"
    "${_opencv_root}/modules/imgproc/include"
    "${_opencv_root}/modules/imgcodecs/include"
    "${_opencv_build}"
    "${_opencv_cfg_inc}")

target_sources(core PRIVATE
    src/imgproc/imgproc.cpp
    src/colorDB/colorDB.cpp
    src/match/match.cpp
    src/calib/calib.cpp
    src/calib/loc.cpp
    src/geo/geo.cpp
    src/geo/export3mf.cpp)

target_link_libraries(core PUBLIC opencv_core opencv_imgproc opencv_imgcodecs)
target_link_libraries(core PUBLIC lib3mf)

